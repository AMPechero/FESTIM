%T = readtable('extract001/T_1_01.csv', 'HeaderLines',1)
clear all
close all
n=1;


legendname={...
'mid-Exposure (1200000.0 s)',...
'end-Exposure (2400000.0 s)',...
'mid-Wait (7800000.0 s)',...
'end-Wait (13200000.0 s)',...
'mid-Backing (14496000.0 s)',...
'end-Backing (15792000.0 s)'...
};

values={...
'./extract001/T', ...
'./extract001/solute_m3', ...
'./extract001/1',...
'./extract001/2', ...
'./extract001/3',...
'./extract001/4',...
'./extract001/retention_m3',...
'./extract001/theta'...
};

valuesnames={...
'Temperature', ...
'Solute', ...
'Trap-1',...
'Trap-2',...
'Trap-3',...
'Trap-4',...
'Retention',...
'PotChem'...
};

valuesunits={...
'(K)', ...
'(mol/m3)' ...
'(mol/m3)',...
'(mol/m3)',...
'(mol/m3)',...
'(mol/m3)',...
'(mol/m3)',...
'(SI)'...
};

coef=[...
1 ...
6.02214076e23 ...
6.02214076e23 ...
6.02214076e23 ...
6.02214076e23 ...
6.02214076e23 ...
6.02214076e23 ...
1 ...
];

for k=1:2

for i=1:length(coef)
n=n+1;
figure(n)
disp([values{i},'_',num2str(k)'])
fprofile=dir([values{i},'_',num2str(k),'_*.csv']);
for j=1:length(fprofile)
  subplot(3,2,j)
fprofile(j).name;
nomfile=fprofile(j).name(1:length(fprofile(j).name)-4);
ftoread=[fprofile(j).folder,'/',fprofile(j).name];
fid = fopen(ftoread);
fgetl(fid) ;
M= textscan(fid, '%f, %f');
fclose (fid);

x=cell2mat(M(:,1));
y=cell2mat(M(:,2));

if k==1
  y(x<0.006&x>-0.006)=-0.0;
end

xred=x(~isnan(y));
yred=y(~isnan(y))/coef(i);

dlmwrite (['./export/',valuesnames{i},'-axe',num2str(k),'-',num2str(j),'.txt'], [xred yred]);

plot(xred,yred,'linewidth',2)
title(legendname{j})
hold on
xlabel(['Axe ',num2str(k),' (m)'])
ylabel([valuesnames{i},valuesunits{i}])
xlim([min(xred),max(xred)])

end

print(['./export/',valuesnames{i},'-axe',num2str(k),'.png'], '-dpng')

end

end